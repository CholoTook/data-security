<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>AAI OIDC Profile | GA4GH Data Security</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="AAI OIDC Profile">
<meta property="og:locale" content="en_US">
<meta name="description" content="AAI">
<meta property="og:description" content="AAI">
<link rel="canonical" href="/data-security/1.2-draft-sequence-diagram/aai-openid-connect-profile">
<meta property="og:url" content="/data-security/1.2-draft-sequence-diagram/aai-openid-connect-profile">
<meta property="og:site_name" content="GA4GH Data Security">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="AAI OIDC Profile">
<script type="application/ld+json">
{"description":"AAI","url":"/data-security/1.2-draft-sequence-diagram/aai-openid-connect-profile","@type":"WebPage","headline":"AAI OIDC Profile","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/data-security/1.2-draft-sequence-diagram/assets/main.css">
<link type="application/atom+xml" rel="alternate" href="/data-security/1.2-draft-sequence-diagram/feed.xml" title="GA4GH Data Security">
</head>
<body>
<header class="site-header" role="banner">

  <div class="wrapper">
<a class="site-title" rel="author" href="/data-security/1.2-draft-sequence-diagram/">GA4GH Data Security</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
<a class="page-link" href="/data-security/1.2-draft-sequence-diagram/aai-introduction">AAI Introduction</a><a class="page-link" href="/data-security/1.2-draft-sequence-diagram/aai-openid-connect-profile">AAI OIDC Profile</a>
</div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">AAI OIDC Profile</h1>
  </header>

  <div class="post-content">
    <h3 class="no_toc" id="abstract">Abstract</h3>

<p>This specification profiles the OpenID Connect protocol (OIDC) to provide a federated
(multilateral) authentication and authorisation infrastructure for greater
interoperability between Genomics institutions in a manner specifically
applicable to (but not limited to) the sharing of restricted datasets.</p>

<p>In particular, this specification introduces a JSON Web Token
(<a href="#relevant-specifications">JWT</a>) syntax for an access token to
enable an OIDC provider (called a <a href="#term-broker">Broker</a>) to allow a downstream
access token consumer (called a <a href="#term-claim-clearinghouse">Claim Clearinghouse</a>)
to locate the Broker’s /userinfo endpoint as a means to fetch <a href="#term-ga4gh-claim">GA4GH
Claims</a>. This specification is suggested to be used together
with others that specify the syntax and semantics of the GA4GH Claims exchanged.</p>

<h3 class="no_toc" id="table-of-contents">Table of Contents</h3>

<ul id="markdown-toc">
  <li><a href="#requirements-notation-and-conventions" id="markdown-toc-requirements-notation-and-conventions">Requirements Notation and Conventions</a></li>
  <li><a href="#terminology" id="markdown-toc-terminology">Terminology</a></li>
  <li><a href="#relevant-specifications" id="markdown-toc-relevant-specifications">Relevant Specifications</a></li>
  <li><a href="#flow-of-claims" id="markdown-toc-flow-of-claims">Flow of Claims</a></li>
  <li>
<a href="#profile-requirements" id="markdown-toc-profile-requirements">Profile Requirements</a>    <ul>
      <li><a href="#clientapplication-conformance" id="markdown-toc-clientapplication-conformance">Client/Application Conformance</a></li>
      <li><a href="#conformance-for-brokers" id="markdown-toc-conformance-for-brokers">Conformance for Brokers</a></li>
      <li><a href="#conformance-for-visa-issuers" id="markdown-toc-conformance-for-visa-issuers">Conformance for Visa Issuers</a></li>
      <li><a href="#conformance-for-claim-clearinghouses-consuming-access-tokens-to-give-access-to-data" id="markdown-toc-conformance-for-claim-clearinghouses-consuming-access-tokens-to-give-access-to-data">Conformance for Claim Clearinghouses (consuming Access Tokens to give access to data)</a></li>
    </ul>
  </li>
  <li>
<a href="#ga4gh-jwt-format" id="markdown-toc-ga4gh-jwt-format">GA4GH JWT Format</a>    <ul>
      <li><a href="#passport-scoped-access-token-issued-by-broker" id="markdown-toc-passport-scoped-access-token-issued-by-broker">Passport-Scoped Access Token issued by Broker</a></li>
      <li><a href="#claims-sent-to-data-holder-by-a-broker-via-userinfo" id="markdown-toc-claims-sent-to-data-holder-by-a-broker-via-userinfo">Claims sent to Data Holder by a Broker via /userinfo</a></li>
      <li>
<a href="#visa-issued-by-visa-issuer" id="markdown-toc-visa-issued-by-visa-issuer">Visa issued by Visa Issuer</a>        <ul>
          <li><a href="#visa-access-token-format" id="markdown-toc-visa-access-token-format">Visa Access Token Format</a></li>
          <li><a href="#visa-document-token-format" id="markdown-toc-visa-document-token-format">Visa Document Token Format</a></li>
        </ul>
      </li>
      <li><a href="#authorizationclaims" id="markdown-toc-authorizationclaims">Authorization/Claims</a></li>
    </ul>
  </li>
  <li>
<a href="#token-revocation" id="markdown-toc-token-revocation">Token Revocation</a>    <ul>
      <li><a href="#claim-source-revokes-claim" id="markdown-toc-claim-source-revokes-claim">Claim Source Revokes Claim</a></li>
      <li><a href="#revoking-access-from-bad-actors" id="markdown-toc-revoking-access-from-bad-actors">Revoking Access from Bad Actors</a></li>
      <li><a href="#limited-damage-of-leaked-tokens" id="markdown-toc-limited-damage-of-leaked-tokens">Limited Damage of Leaked Tokens</a></li>
      <li>
<a href="#appendix---sequence-diagrams" id="markdown-toc-appendix---sequence-diagrams">Appendix - Sequence Diagrams</a>        <ul>
          <li><a href="#callback-userinfo-flow" id="markdown-toc-callback-userinfo-flow">Callback (Userinfo) Flow</a></li>
          <li><a href="#exchange-flow" id="markdown-toc-exchange-flow">Exchange Flow</a></li>
        </ul>
      </li>
      <li><a href="#specification-revision-history" id="markdown-toc-specification-revision-history">Specification Revision History</a></li>
    </ul>
  </li>
</ul>

<h3 id="requirements-notation-and-conventions">Requirements Notation and Conventions</h3>

<p>This specification inherits terminology from the <a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID
Connect</a> and the <a href="https://tools.ietf.org/html/rfc6749">OAuth
2.0 Framework (RFC 6749)</a> specifications.</p>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
“SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this specification are to
be interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC2119</a>.</p>

<h3 id="terminology">Terminology</h3>

<p><a name="term-ga4gh-claim"></a> <strong>GA4GH Claim</strong> – A JWT claim as defined by a GA4GH
documented technical standard that is making use of this AAI specification. Typically
this is the <code class="language-plaintext highlighter-rouge">ga4gh_passport_v1</code> or <code class="language-plaintext highlighter-rouge">ga4gh_visa_v1</code> claim for GA4GH Passports v1.x.
Note that GA4GH is not the organization making the claim nor taking responsibility
for the claim as this is a reference to a GA4GH documented standard only.</p>

<p><a name="term-claim-management-system"></a> <strong>Claim Management System</strong> – a service
that allows <a href="#term-claim-source">Claim Source</a> users to manage claims and update one
or more <a href="#term-claim-repository">Claim Repositories</a>. For instance, a data owner
of a controlled access dataset would typically interact with a Claim Management
System to add or remove claims from a <a href="#term-claim-repository">Claim Repository</a>.</p>

<p><a name="term-claim-repository"></a> <strong>Claim Repository</strong> – a service that
manages the durable storage and retrieval of claims (such as a database),
along with any metadata and/or audit logs related to claim creation,
modification, and deletion.</p>

<p><a name="term-claim-source"></a> <strong>Claim Source</strong> – the source organization of
a claim assertion which at a minimum includes the organization associated with
asserting the claim, although can optionally identify a sub-organization or a
specific assignment within the organization that made the claim.</p>

<ul>
  <li>This is NOT necessarily the organization that stores the claim, nor the
<a href="#term-broker">Broker</a>’s organization that signs the token; it is the
organization that has the authority to assert the claim on behalf of the
user and is responsible for making and maintaining the assertion.</li>
</ul>

<p><a name="term-identity-provider"></a> <strong>Identity Provider (IdP)</strong> – a
service that provides to users an identity, authenticates it; and provides
claims to a Broker using standard protocols, such as OpenID Connect, SAML or
other federation protocols. Example: eduGAIN, Google Identity, Facebook, NIH
ERACommons. IdPs MAY be claims sources.</p>

<p><a name="term-broker"></a> <strong>Broker</strong> – An OIDC Provider service that
authenticates a user (potentially by an Identity Provider), collects their
claims from internal and/or upstream claim sources and issues conformant JWT
claims to be consumed by <a href="#term-claim-clearinghouse">Claim Clearinghouses</a>.
Brokers may also be Claim Clearinghouses of other upstream Brokers (i.e.
create a chain of Brokers like in the
<a href="#flow-of-claims">Flow of Claims diagram</a>).</p>

<p><a name="term-claim-clearinghouse"></a> <strong>Claim Clearinghouse</strong> – A consumer
of <a href="#term-ga4gh-claim">GA4GH Claims</a> (i.e. an OIDC Relying Party or a service
downstream), that were provided by a <a href="#term-broker">Broker</a>, to make an
authorization decision at least in part based on inspecting GA4GH claims and
allows access to a specific set of underlying resources in the target
environment or platform. This abstraction allows for a variety of models for
how systems consume these claims in order to provide access to resources.
Access can be granted by either issuing new access tokens for downstream
services (i.e. the Claim Clearinghouse may act like an authorization server)
or by providing access to the underlying resources directly (i.e. the Claim
Clearinghouse may act like a resource server). Some Claim Clearinghouses may
issue access tokens that may contain a new set of GA4GH Claims and/or a
subset of GA4GH claims for downstream consumption.</p>

<p><a name="term-data-holder"></a> <strong>Data Holder</strong> – An organization that
protects a specific set of data. They hold data (or its copy) and respects
and enforces the data owner’s decisions on who can access it. A data owner
can also be a data holder. Data holders run an
<a href="#term-claim-clearinghouse">Claim Clearinghouse Server</a> at a minimum.</p>

<p><a name="term-data-owner"></a> <strong>Data Owner</strong> – An organization that manages
data and, in that role, has capacity to decide who can access it. For
instance, a Data Access Committee (DAC).</p>

<p><a name="term-passport-scoped-access-token"></a> <strong>Passport-Scoped OAuth Access
Token</strong> – A JWT bearer token, returned as an OAuth2 access token as
described herein, encoded via JWS Compact Serialization per
<a href="https://datatracker.ietf.org/doc/html/rfc7515">RFC7515</a>, containing
<code class="language-plaintext highlighter-rouge">ga4gh_passport_v1</code> as a space-separated entry within the <code class="language-plaintext highlighter-rouge">scope</code> claim but
does not contain <a href="#term-ga4gh-claim">GA4GH Claims</a>.</p>

<p><a name="term-visa-issuer"></a> <a name="term-embedded-token-issuer"></a>
<strong>Visa Issuer</strong> (aka “Embedded Token Issuer”) – a service that signs
<a href="#term-visa">Visas</a>.</p>

<p><a name="term-visa"></a> <a name="term-embedded-token"></a>
<strong>Visa</strong> (aka “Embedded Token”) – A <a href="#term-ga4gh-claim">GA4GH Claim</a>
value or entry within a list or object of a GA4GH Claim that contains a JWT
encoded via JWS Compact Serialization per
<a href="https://datatracker.ietf.org/doc/html/rfc7515">RFC7515</a>.
It MUST be signed by a <a href="#term-visa-issuer">Visa Issuer</a>. A Visa MAY be passed
through various <a href="#term-broker">Brokers</a> as needed while retaining the token
signature of the original Visa Issuer.</p>

<h3 id="relevant-specifications">Relevant Specifications</h3>

<p><a href="http://openid.net/specs/openid-connect-core-1_0.html">OIDC Spec</a> -
Authorization Code Flow and Implicit Flow will generate id_tokens and
access_tokens from the Broker.</p>

<p><a href="https://tools.ietf.org/html/rfc7519">JWT</a> - Specific implementations MAY extend
this structure with their own service-specific JWT claim names as top-level
members of this JSON object. Recommended “extensions” are in the
<a href="#authorizationclaims">Permissions</a> section. The JWT specified here follows JWS
headers specification from <a href="https://tools.ietf.org/html/rfc7515">RFC7515</a>.</p>

<p><a href="https://tools.ietf.org/html/rfc7515">JWS</a> - JSON Web Signature (JWS) is the
specific JWT to use for this spec.</p>

<p><a href="https://tools.ietf.org/html/rfc5246">Transport Layer Security (TLS, RFC 5246</a>).
Information passed among clients, Applications, Brokers, and Claim
Clearinghouses MUST be protected using TLS.</p>

<p><a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OIDC Discovery</a></p>

<p><a href="https://tools.ietf.org/html/rfc6819">OAuth 2.0 Threat Model and Security Considerations (RFC 6819)</a>.</p>

<p><a href="https://github.com/ga4gh-duri/ga4gh-duri.github.io/blob/master/researcher_ids/ga4gh_passport_v1.md">GA4GH Passport</a></p>

<h3 id="flow-of-claims">Flow of Claims</h3>

<p><img src="/data-security/1.2-draft-sequence-diagram/AAI/claim_flow_of_data_basic.svg" alt="FlowOfClaims"></p>

<p>The above diagram shows how claims flow from a <a href="#term-claim-source">Claim
Source</a> to a <a href="#term-claim-clearinghouse">Claim
Clearinghouse</a> that uses them. This does not
label all of the Relying Party relationships along this chain, where
each recipient in the chain is typically – but not always – the
relying party of the auth flow that fetches the claims from upstream.</p>

<p>Implementations may introduce clients, additional services, and protocols –
not detailed in the above diagram – to provide the mechanisms to move the data
between the Claim Repository and the <a href="#term-broker">Broker</a>.
These mechanisms are unspecified by the scope of this specification except that
they MUST adhere to security and privacy best practices, such as those outlined
in this specification, in their handling of protocols, claims, tokens and
related data. The flow between these components (represented by black arrows)
MAY not be direct or conversely services shown as being separate MAY be
combined into one service. For example, some implementations MAY deploy one
service that handles the responsibilities of both the Visa Issuer and
the Broker.</p>

<h3 id="profile-requirements">Profile Requirements</h3>

<h4 id="clientapplication-conformance">Client/Application Conformance</h4>

<ol>
  <li>
    <p>Confidential clients (keep the client secret secure - typically
server-side web-applications) MUST implement OIDC Authorization Code
Flow (with Confidential Client)
<a href="http://openid.net/specs/openid-connect-basic-1_0.html">http://openid.net/specs/openid-connect-basic-1_0.html</a></p>
  </li>
  <li>
    <p>Public Clients (typically javascript browser clients)
SHOULD implement OIDC Implicit Flow
(<a href="http://openid.net/specs/openid-connect-implicit-1_0.html">http://openid.net/specs/openid-connect-implicit-1_0.html</a>)</p>

    <ol>
      <li>
        <p>MUST use “id_token token” response_type for authentication.</p>
      </li>
      <li>
        <p>Public Clients like mobile apps that use Authorization Code Grant SHOULD implement some additional protection such as PKCE (<a href="https://tools.ietf.org/html/rfc7636">https://tools.ietf.org/html/rfc7636</a>) .</p>
      </li>
    </ol>
  </li>
  <li>
    <p>Conform to <a href="#token-revocation">revocation requirements</a>.</p>
  </li>
  <li>
    <p>Protection of Confidential Information</p>

    <ol>
      <li>
        <p>Sensitive information (e.g., including client secrets,
authorization codes, id_tokens, access_tokens) will be passed over
encrypted channels as per
<a href="https://openid.net/specs/openid-connect-basic-1_0.html">OpenIDC Implementation Guide</a>.</p>
      </li>
      <li>
        <p>All responses that contain tokens, secrets, or other sensitive
information MUST include the following HTTP response header fields and
values (as per <a href="https://openid.net/specs/openid-connect-basic-1_0.html">OpenIDC Implementation Guide</a>).</p>

        <ol>
          <li>
            <p>Cache-Control: no-store</p>
          </li>
          <li>
            <p>Pragma: no-cache</p>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
    <p>MUST provide protection against Client attacks as outlined in
<a href="https://tools.ietf.org/html/rfc6819">RFC 6819</a>.</p>
  </li>
</ol>

<h4 id="conformance-for-brokers">Conformance for Brokers</h4>

<ol>
  <li>
    <p>Brokers operate downstream from IdPs or provide their own IdP service. They
issue id_tokens and access_tokens (and potentially refresh tokens) for
consumption within the GA4GH compliant environment.</p>

    <ol>
      <li>
        <p>A Broker MUST issue both <a href="#term-passport-scoped-access-token">Passport-Scoped Access Tokens</a>
(access_tokens) and id_tokens.</p>

        <ol>
          <li>This document makes no specifications for id_tokens.</li>
        </ol>
      </li>
      <li>
        <p>Access_tokens MUST be in JWS format</p>

        <ol>
          <li>
            <p>Access tokens for GA4GH use MUST be a <a href="#ga4gh-jwt-format">GA4GH JWT</a> using
<a href="#passport-scoped-access-token-issued-by-broker">Passport-Scoped Access Token format</a>.</p>
          </li>
          <li>
            <p>Access tokens do not contain GA4GH Claims directly in the access token.</p>
          </li>
          <li>
            <p>Access tokens MAY contain non-GA4GH Claims directly in the access token.</p>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
    <p>Broker MUST support <a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OIDC Discovery
spec</a></p>

    <ol>
      <li>MUST include and support proper
<a href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata">Metadata</a>
(i.e. must have a <code class="language-plaintext highlighter-rouge">jwks_uri</code> as required that’s reachable by a Claim
Clearinghouse)</li>
    </ol>
  </li>
  <li>
    <p>Broker MUST support public-facing /userinfo endpoint as per <a href="https://openid.net/specs/openid-connect-core-1_0.html#UserInfo">section 5.3 of the OIDC
specification</a>.</p>

    <ol>
      <li>
        <p>When presented with a valid access token, the /userinfo endpoint MUST return
claims in the specified
<a href="#claims-sent-to-data-holder-by-a-broker-via-userinfo">User Info Format</a> using
either an <code class="language-plaintext highlighter-rouge">application/json</code> or <code class="language-plaintext highlighter-rouge">application/jwt</code> encoding.</p>
      </li>
      <li>
        <p>The Broker MUST include the claims_parameter_supported in the discovery service
to indicate whether or not the Broker supports the <a href="https://openid.net/specs/openid-connect-core-1_0.html#ClaimsParameter">OIDC claims request
parameter</a>
on /userinfo to subset which claim information will be returned. If the Broker
does not support the OIDC claims request parameter, then all claim information
for the provided scopes eligible for release to the requester MUST be returned.</p>
      </li>
    </ol>
  </li>
  <li>
    <p>Broker MUST provide protection against attacks as outlined in
<a href="https://tools.ietf.org/html/rfc6819">RFC 6819</a>.</p>
  </li>
  <li>
    <p>The user represented by the identity of the access token MUST have agreed to
release claims related to the requested scopes as part of generating tokens
that can expose GA4GH Claims that represent user data or permissions.
Brokers MUST adhere to
<a href="https://openid.net/specs/openid-connect-core-1_0.html#Consent">section 3.1.2.4 of the OIDC specification</a>.</p>

    <ol>
      <li>
        <p>The user represented by a Researcher Identity MUST approve the release
of these claims to relying parties with sufficient granularity to
allow for responsible disclosure of information best practices as well
as to meet privacy regulations that may be applicable within or between
jurisdictions where the user’s identity will be used (e.g. GDPR for
a European Union user).</p>
      </li>
      <li>
        <p>If the user’s release agreement has been remembered as part of a user’s
settings such that the user no longer needs to be prompted, then the
user MUST have the ability to remove this setting (i.e. be prompted
again in the future). If a feature is to bypass prompts by remembering
settings is available, it MUST only be used as an opt-in feature with
explicit controls available to the user.</p>
      </li>
      <li>
        <p>A user’s withdrawal of this agreement does not need to apply to
previously generated access tokens.</p>
      </li>
    </ol>
  </li>
  <li>
    <p>By signing an access token, an Broker asserts that the GA4GH Claims that
token makes available at the /userinfo endpoint – not including any
Visas – were legitimately derived from their <a href="#term-claim-source">Claim
Sources</a>, and the content is presented and/or
transformed without misrepresenting the original intent.</p>

    <p>When a Broker acts as a Visa Issuer and signs Visas, then those signatures
adhere to the same assertion criteria as outlined in the <a href="#conformance-for-visa-issuers">Conformance
for Visa Issuers</a> section of this
specification.</p>

    <p>When a Broker provides Embedded Tokens from other Visa Issuers, it is providing
them “as is” (i.e. it provides no additional assurance as to the quality,
authenticity, or trustworthiness of the claims from such tokens and any such
assurances are made by the issuer of the Visa, i.e. the Visa Issuer).</p>
  </li>
</ol>

<p><a name="conformance-for-embedded-token-issuers"></a></p>
<h4 id="conformance-for-visa-issuers">Conformance for Visa Issuers</h4>

<ol>
  <li>
    <p>A <a href="#term-visa-issuer">Visa Issuer</a> MUST provide one or more of the following
types of <a href="#term-visa">Visas</a>:</p>

    <ol>
      <li>
        <p><a name="term-visa-access-token"></a> <a name="term-embedded-access-token"></a>
<strong>Visa Access Token</strong> – The Visa Issuer is providing an OIDC provider
service and issues OIDC-compliant access tokens in a specific format that can
be used as a Visa.</p>

        <ol>
          <li>
            <p>The Visa payload MUST contain the “openid” scope. That
is, it has a <code class="language-plaintext highlighter-rouge">scope</code> JWT claim that contains “openid” as a
space-delimited substring.</p>
          </li>
          <li>
            <p>Visa is a JWS string and follows the <a href="#visa-access-token-format">Visa Access Token
Format</a>. This includes
having GA4GH Claims as JWT claims directly in the Visa.</p>
          </li>
          <li>
            <p>Visa Issuer MUST support <a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OIDC Discovery
spec</a>,
and provide <code class="language-plaintext highlighter-rouge">jwks_uri</code> as
<a href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata">Metadata</a>
that may be reachable by a Claim Clearinghouse.</p>
          </li>
          <li>
            <p>Visa Issuer MUST support public-facing
/userinfo endpoint. When presented with a valid Visa Access
Token, the /userinfo endpoint MUST return a success status
and MAY return the current values for GA4GH Claims that were
included within the Visa Access Token, however returning
GA4GH Claims from the /userinfo endpoint for Visa Access
Tokens is OPTIONAL.</p>
          </li>
          <li>
            <p>If the Visa Access Token’s <code class="language-plaintext highlighter-rouge">exp</code> exceeds the <code class="language-plaintext highlighter-rouge">iat</code> by
more than 1 hour, the Visa Issuer should expect
Claim Clearinghouses to use <a href="#at-polling">Access Token Polling</a> and
MUST provide a means to revoke Visa Access Tokens. The
/userinfo endpoint MUST return an HTTP status 401 as per
<a href="https://tools.ietf.org/html/rfc6750#section-3.1">RFC6750 section 3.1</a>
when provided an Visa Access Token that has completed the
revocation process.</p>
          </li>
          <li>
            <p>The JWS header MUST NOT have <code class="language-plaintext highlighter-rouge">jku</code> specified.</p>
          </li>
          <li>
            <p>Visa Issuer MUST provide protection against
attacks as outlined in <a href="https://tools.ietf.org/html/rfc6819">RFC
6819</a>.</p>
          </li>
        </ol>
      </li>
      <li>
        <p><a name="term-visa-document-token"></a> <a name="term-embedded-document-token"></a>
<strong>Visa Document Token</strong> – The Visa Issuer does not need to
be a OIDC provider, and MAY provide tokens of this type without any
revocation process.</p>

        <ol>
          <li>
            <p>The JWS header contains <code class="language-plaintext highlighter-rouge">jku</code> as specified by <a href="https://tools.ietf.org/html/rfc7515#section-4.1.2">RFC7515 Section
4.1.2</a>, and
provides the corresponding public-facing endpoint to fetch
the public key used to sign the Visa Document Token.</p>
          </li>
          <li>
            <p>Follows the <a href="#visa-document-token-format">Visa Document Token
Format</a>.</p>
          </li>
          <li>
            <p>The token is not treated as an access token, but validity
checks outlined elsewhere in this specification still apply.</p>
          </li>
          <li>
            <p>MUST conform to <a href="#token-revocation">token limited-life or revocation
requirements</a>, even if no Visa token
revocation process is provided.</p>
          </li>
          <li>
            <p>The <code class="language-plaintext highlighter-rouge">scope</code> JWT claim, if included, MUST NOT contain “openid” as
a space-delimited substring.</p>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
    <p>A Visa Issuer MAY generate the <code class="language-plaintext highlighter-rouge">exp</code> timestamp to enforce
its policies and allow Claim Clearinghouses to understand the intent of
how long the claim may be used before needing to return to the Visa Issuer
to refresh the claim. As a non-normative example, if a
GA4GH claim expires in 25 years (or even never expires explictly in the
Claim Repository), the Visa Issuer could set the <code class="language-plaintext highlighter-rouge">exp</code> to
1 day into the future plus issue a refresh token in order to force the
refresh token to be used when a downstream Claim Clearinghouse is still
interested in using such a claim after 1 day elapses.</p>
  </li>
  <li>
    <p>By signing a Visa, a Visa Issuer asserts that
the GA4GH claims made available by the token were legitimately derived
from their <a href="#term-claim-source">Claim Sources</a>, and the content is
presented and/or transformed without misrepresenting the original intent,
except for accommodating for <code class="language-plaintext highlighter-rouge">exp</code> timestamps to be represented as
indicated above.</p>
  </li>
</ol>

<h4 id="conformance-for-claim-clearinghouses-consuming-access-tokens-to-give-access-to-data">Conformance for Claim Clearinghouses (consuming Access Tokens to give access to data)</h4>

<ol>
  <li>
    <p>Claim Clearinghouses MUST trust at least one Broker.</p>

    <ol>
      <li>
        <p>Claim Clearinghouses MAY trust more than one Broker</p>
      </li>
      <li>
        <p>The responsibility of risk assessment of a Broker is on the Claim Clearinghouse to trust an access token. RECOMMENDED to trust the minimum set of Brokers required to obtain the access token payload.</p>
      </li>
    </ol>
  </li>
  <li>
    <p>Claim Clearinghouses MUST either check the validity of the access token or treat the access
token as opaque.</p>

    <ol>
      <li>
        <p>If treating the token as a JWT a Claim Clearinghouse:</p>

        <ol>
          <li>
            <p>Even though JWTs are expected to be submitted against /userinfo, a Claim Clearinghouse SHOULD check the Token’s signature via JWKS or having stored the
public key.</p>

            <ol>
              <li>A metadata URL (.well-known URL) SHOULD be used here to use the
jwks_uri parameter.</li>
            </ol>
          </li>
          <li>
            <p>MUST check <code class="language-plaintext highlighter-rouge">iss</code> attribute to ensure a trusted Broker has generated
the token.</p>

            <ol>
              <li>If evaluating a Visa, trust MUST be established based
on the signer of the Visa itself. In Claim
Clearinghouses participating in open federation, the Claim
Clearinghouse does not necessarily have to trust the Broker that
includes Visas within another token in order to use
the Visa (although the Claim Clearinghouse MAY require
any other Broker involved in the propagation of the claims to
also be trusted if the Claim Clearinghouse needs to restrict its
trust model).</li>
            </ol>
          </li>
          <li>
            <p>MUST check <code class="language-plaintext highlighter-rouge">exp</code> to ensure the token has not expired.</p>
          </li>
          <li>
            <p>MAY additionally check <code class="language-plaintext highlighter-rouge">aud</code> to make sure Relying Party is trusted
(client_id).</p>
          </li>
        </ol>
      </li>
      <li>
        <p>If treating the token as an opaque a Claim Clearinghouse MUST know in
advance where to find a corresponding /userinfo. This may limit the
functionality of accepting tokens from some Brokers.</p>
      </li>
    </ol>
  </li>
  <li>
    <p>Claim Clearinghouse or downstream applications MAY use <a href="https://openid.net/specs/openid-connect-core-1_0.html#UserInfo">/userinfo
endpoint</a>
(derived from the access_token JWT’s <code class="language-plaintext highlighter-rouge">iss</code>) to request claims and MAY make
use of the <a href="https://openid.net/specs/openid-connect-core-1_0.html#ClaimsParameter">OIDC claims request
parameter</a>
to subset which claims are requested if supported by the Broker for the
claims in question.</p>
  </li>
  <li>
    <p>Claim Clearinghouses service can be a Broker itself and would follow the
<a href="#conformance-for-brokers">Conformance For Brokers</a>.</p>
  </li>
  <li>
    <p>Claim Clearinghouses MUST provide protection against attacks as outlined in
<a href="https://tools.ietf.org/html/rfc6819">RFC 6819</a>.</p>

    <ol>
      <li>Section 5.1.6 of RFC 6819 contains a SHOULD section that
states <code class="language-plaintext highlighter-rouge">Ensure that client applications do not share tokens with 3rd parties.</code> This 
profile provides a mechanism for Clearinghouses to consume access tokens from
multiple brokers in a manner that does not involve 3rd parties. Client applications
SHOULD take care to not spread the tokens to any other services
that would be considered 3rd parties.</li>
    </ol>
  </li>
  <li>
    <p>If making use of <a href="#term-visa">Visas</a>:</p>

    <ol>
      <li>
        <p>The Claim Clearinghouse MUST validate that all token checks pass (such as
the token hasn’t expired) as described elsewhere in this specification and
the underlying OIDC specifications.</p>
      </li>
      <li>
        <p>If making use of <a href="#term-visa-access-token">Visa Access Tokens</a>:</p>

        <ol>
          <li>
            <p>Token checks MUST be performed to ensure it complies with the access
token specification.</p>
          </li>
          <li>
            <p>In addition to other validation checks, a Visa is considered
invalid if it is more than 1 hour old (as per the <code class="language-plaintext highlighter-rouge">iat</code> claim) AND
<a href="#at-polling">Access Token Polling</a> does not confirm that the token is still
valid (e.g. provide a success status code).</p>
          </li>
        </ol>
      </li>
      <li>
        <p>If making use of <a href="#term-visa-document-token">Visa Document Tokens</a>:</p>

        <ol>
          <li>
            <p>Fetching the public keys using the <code class="language-plaintext highlighter-rouge">jku</code> is not required if a Claim
Clearinghouse has received the keys for the given <code class="language-plaintext highlighter-rouge">iss</code> via a trusted,
out-of-band process.</p>
          </li>
          <li>
            <p>If a Claim Clearinghouse is to use the <code class="language-plaintext highlighter-rouge">jku</code> URL to fetch the public
keys to verify the signature, then it MUST verify that the <code class="language-plaintext highlighter-rouge">jku</code> is
trusted for the given <code class="language-plaintext highlighter-rouge">iss</code> as part of the Claim Clearinghouse’s
trusted issuer configuration. This check MUST be performed before
calling the <code class="language-plaintext highlighter-rouge">jku</code> endpoint.</p>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li>
    <p><a name="at-polling"></a> <strong>Access Token Polling</strong>: Clients MAY use access tokens,
including Visas, to occasionally check which claims are still valid
at the associated /userinfo endpoint in order to establish whether the user
still meets the access requirements.</p>

    <p>This MUST NOT be done more than once per hour (excluding any optional retries)
per Claim Clearinghouse. Any request retries MUST include exponential backoff
delays based on best practices (e.g. include appropriate jitter). At a
minimum, the client MUST stop checking once any of the following occurs:</p>

    <ol>
      <li>
        <p>The system can reasonably determine that authorization related to these
claims is no longer needed by the user. For example, all downstream cloud
tasks have terminated and the related systems will no longer be using the
access token nor any downstream tokens that were authorized by evaluating
access requirements against claims in the token.</p>
      </li>
      <li>
        <p>The JWT access token has expired as per the <code class="language-plaintext highlighter-rouge">exp</code> field.</p>
      </li>
      <li>
        <p>The client has detected that the user owning the identity or a system
administrator has revoked the access token or a refresh token related to
minting the access token.</p>
      </li>
      <li>
        <p>The /userinfo endpoint returns an HTTP status that is not retryable.
For example, /userinfo returns HTTP status 400.</p>
      </li>
      <li>
        <p>If the /userinfo endpoint returns an updated set of GA4GH Claims (this is
an OPTIONAL feature of an Visa Issuer), then the Claim
Clearinghouse MUST use the updated GA4GH Claims and ignore the original
GA4GH Claim values in the Visa Access Token. If the Claim
Clearinghouse is unable to adjust for the updated GA4GH Claims, then
it MUST act as though the token was revoked.</p>
      </li>
    </ol>
  </li>
</ol>

<h3 id="ga4gh-jwt-format">GA4GH JWT Format</h3>

<p>A well-formed JWS-Encoded JSON Web Token (JWT) consists of three concatenated
Base64url-encoded strings, separated by dots (.) The three sections are: header,
payload and signature. These JWTs follow <a href="https://tools.ietf.org/html/rfc7515">RFC7515</a> (JWS)
and utilize a number of <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">standard JWT claim names</a>
as per the registration process.
This profile is agnostic to the format of the id_token.</p>

<p><a name="access_token-issued-by-broker"></a></p>
<h4 id="passport-scoped-access-token-issued-by-broker">Passport-Scoped Access Token issued by Broker</h4>

<p>Header - The <code class="language-plaintext highlighter-rouge">kid</code> parameter (see <a href="https://tools.ietf.org/html/rfc7515#section-4.1.4">RFC7515 section
4.1.4</a>) must be included
and <code class="language-plaintext highlighter-rouge">alg</code> must be “RS256”.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
 "typ": "JWT",
 "alg": "RS256",
 "kid": "&lt;key-identifier&gt;"
}
</code></pre></div></div>

<p>Payload:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
 "iss": "https://&lt;issuer-website&gt;/",
 "sub": "&lt;subject-identifier&gt;",
 "idp": "&lt;short-idp-identifier&gt;",
 "aud": [
  "&lt;client-id1&gt;",
  "&lt;client-id2&gt;" ...
 ],
 "iat": &lt;seconds-since-epoch&gt;,
 "exp": &lt;seconds-since-epoch&gt;,
 "jti": &lt;token-identifier&gt;,
 "scope": "openid &lt;ga4gh-passport-scopes&gt;",
 &lt;additional claims&gt;
}
</code></pre></div></div>
<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">iss</code>: REQUIRED. MUST be able to be appended with
.well-known/openid-configuration to get spec of Broker.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">sub</code>: REQUIRED. Authenticated user unique identifier.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">idp</code>: OPTIONAL. SHOULD contain the IDP the user used to auth with.
A non-normative example is “google”. This does not have to be unique and
can be used just to help inform if that is what a data owner or data holder
needs.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">aud</code>: OPTIONAL. If provided, it MUST contain the Oauth Client ID of the
relying party.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">iat</code>: REQUIRED. Time issued.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">exp</code>: REQUIRED. Time expired.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">jti</code>: RECOMMENDED. a unique identifier for the token as per
<a href="https://tools.ietf.org/html/rfc7519#section-4.1.7">RFC7519 Section 4.1.7</a></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">scope</code>: REQUIRED. Includes verified scopes. MUST include “openid”. Will also
include any <code class="language-plaintext highlighter-rouge">&lt;ga4gh-passport-scopes&gt;</code> from the GA4GH Passport specification
(e.g. “ga4gh_passport_v1” is the <a href="https://github.com/ga4gh-duri/ga4gh-duri.github.io/blob/master/researcher_ids/ga4gh_passport_v1.md#requirement-7">scope for GA4GH
Passports</a>).
The <code class="language-plaintext highlighter-rouge">scope</code> claim is defined by <a href="https://datatracker.ietf.org/doc/html/rfc8693#section-4.2">RFC8693 section 4.2</a>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">addtional claims</code>: OPTIONAL. Any other additional non-GA4GH claims are allowed. This specification does not dictate the format of other claims.</p>
  </li>
</ul>

<h4 id="claims-sent-to-data-holder-by-a-broker-via-userinfo">Claims sent to Data Holder by a Broker via /userinfo</h4>

<p>Only the GA4GH claims truly must be as prescribed here. Refer to OIDC Spec for
more information. The /userinfo endpoint MAY use <code class="language-plaintext highlighter-rouge">application/json</code> or
<code class="language-plaintext highlighter-rouge">application/jwt</code>. If <code class="language-plaintext highlighter-rouge">application/jwt</code> is returned, it MUST be signed as per
<a href="https://openid.net/specs/openid-connect-core-1_0.html#UserInfoResponse">UserInfo</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
 "iss": "https://&lt;issuer-website&gt;/",
 "sub": "&lt;subject-identifier&gt;",
 "aud": [
  "&lt;client-id1&gt;",
  "&lt;client-id2&gt;" ...
 ],
 &lt;ga4gh-visa-claims&gt;
}
</code></pre></div></div>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">iss</code> and <code class="language-plaintext highlighter-rouge">sub</code>: REQUIRED.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">aud</code>: OPTIONAL.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">&lt;ga4gh-visa-claims&gt;</code>: OPTIONAL. GA4GH Claims are generally included as
specified by the GA4GH Passport specification based on the Passport-Scoped
Access Token’s scope provided. Even when requested by the appropriate scopes,
these GA4GH Claims may not be included in the response for various reasons, such
as if the user does not have any GA4GH Claims. See
<a href="#authorizationclaims">Authorization/Claims</a> for an example of a GA4GH
Claim.</p>
  </li>
</ul>

<p><a name="embedded-token-issued-by-embedded-token-issuer"></a></p>
<h4 id="visa-issued-by-visa-issuer">Visa issued by Visa Issuer</h4>

<p>There are two supported formats for Visas.</p>

<p><a name="embedded-access-token-format"></a></p>
<h5 id="visa-access-token-format">Visa Access Token Format</h5>

<p>Header format:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
 "typ": "JWT",
 "alg": "RS256",
 "kid": "&lt;key-identifier&gt;"
}
</code></pre></div></div>

<p>where:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">alg</code> MUST be “RS256”.</p>
  </li>
  <li>
    <p>The header MUST NOT contain a <code class="language-plaintext highlighter-rouge">jku</code>.</p>
  </li>
</ol>

<p>Payload format:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
 "iss": "https://&lt;issuer-website&gt;/",
 "sub": "&lt;subject-identifier&gt;",
 "iat": &lt;seconds-since-epoch&gt;,
 "exp": &lt;seconds-since-epoch&gt;,
 "jti": &lt;token-identifier&gt;,
 "scope": "openid &lt;ga4gh-spec-scopes&gt;"
 &lt;ga4gh-visa-claims&gt;
}
</code></pre></div></div>

<p>where:</p>

<ol>
  <li>
    <p>The standard JWT payload claims <code class="language-plaintext highlighter-rouge">iss</code>, <code class="language-plaintext highlighter-rouge">sub</code>, <code class="language-plaintext highlighter-rouge">iat</code>, <code class="language-plaintext highlighter-rouge">exp</code> are
all REQUIRED.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">jti</code> is RECOMMENDED.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">scope</code> is REQUIRED and MUST be a string containing a space-delimited set of
scope names. “openid” MUST be included as a scope name. The <code class="language-plaintext highlighter-rouge">scope</code> claim
name is defined by <a href="https://datatracker.ietf.org/doc/html/rfc8693#section-4.2">RFC8693 section 4.2</a>.</p>
  </li>
  <li>
    <p>The payload claims MAY contain at least one GA4GH Claim
(<code class="language-plaintext highlighter-rouge">&lt;ga4gh-visa-claims&gt;</code>).</p>
  </li>
  <li>
    <p>The payload claims MUST NOT include <code class="language-plaintext highlighter-rouge">aud</code>.</p>
  </li>
</ol>

<p><a name="embedded-document-token-format"></a></p>
<h5 id="visa-document-token-format">Visa Document Token Format</h5>

<p>Conforms with JWS format requirements and is signed by a Visa Issuer.</p>

<ol>
  <li>
    <p>MUST be a JWS string.</p>
  </li>
  <li>
    <p>MUST contain a <code class="language-plaintext highlighter-rouge">jku</code> in the header.</p>
  </li>
  <li>
    <p>MUST NOT contain “openid” as a space-delimited substring of the <code class="language-plaintext highlighter-rouge">scope</code>
JWT claim, if the <code class="language-plaintext highlighter-rouge">scope</code> claim is provided.</p>
  </li>
  <li>
    <p>The following headers and JWT claims in the payload are REQUIRED
(here shown in its decoded JSON form):</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>{
  "typ": "JWT",
  "alg": "RS256",
  "jku": "https://&lt;jwk-URL&gt;",
  "kid": "&lt;key-identifier&gt;"
}.
{
  "iss": "https://&lt;issuer-website&gt;/",
  "sub": "&lt;subject-identifier&gt;",
  "iat": &lt;seconds-since-epoch&gt;,
  "exp": &lt;seconds-since-epoch&gt;,
  "jti": &lt;token-identifier&gt;,
  &lt;ga4gh-visa-claims&gt;
}.
&lt;signature&gt;
</code></pre></div>    </div>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">typ</code>: MUST be “JWT”.</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">alg</code>: MUST be “RS256”.</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">jti</code>: RECOMMENDED. A unique identifier for the token as per
<a href="https://tools.ietf.org/html/rfc7519#section-4.1.7">RFC7519 Section 4.1.7</a>
is RECOMMENDED.</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">&lt;ga4gh-visa-claims&gt;</code>: OPTIONAL. One or more GA4GH Claims MAY be
provided. See <a href="#authorizationclaims">Authorization/Claims</a> for an
example.</p>
      </li>
    </ul>
  </li>
</ol>

<h4 id="authorizationclaims">Authorization/Claims</h4>

<p>User attributes and claims are being developed in the <a href="https://github.com/ga4gh-duri/ga4gh-duri.github.io/blob/master/researcher_ids/ga4gh_passport_v1.md">GA4GH Passport
specification</a>
by the DURI work stream.</p>

<p>A non-normative example of a GA4GH Passport, as referred to
in as <code class="language-plaintext highlighter-rouge">&lt;ga4gh-passport-claims&gt;</code> within the JWT formatting sections of this
specification, is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"ga4gh_passport_v1": [
  &lt;ga4gh passport value&gt;
]
</code></pre></div></div>

<p>See the <a href="https://github.com/ga4gh-duri/ga4gh-duri.github.io/blob/master/researcher_ids/ga4gh_passport_v1.md#passport-claim-format">GA4GH Passport
Claim Format</a>
for more details.</p>

<h2 id="token-revocation">Token Revocation</h2>

<h4 id="claim-source-revokes-claim">Claim Source Revokes Claim</h4>

<p>Given that claims can cause downstream access tokens to be minted by Claim
Clearinghouses and such downstream access tokens may have little knowledge or no
connectivity to sources of claims, it can be challenging to build robust
revocation capabilities across highly federated and loosely coupled systems.
During the lifetime of the downstream access token, some systems may require
that claims are no longer inspected nor updated.</p>

<p>In the event that a <a href="#term-claim-source">Claim Source</a> revokes a claim within
a <a href="#term-claim-repository">Claim Repository</a>, downstream Visa
Issuers, Brokers, Claim Clearinghouses, and other Authorization or Resource
Servers MUST at a minimum provide a means to limit the lifespan of any given
access tokens generated as a result of claims. To achieve this goal, servers
involved with access may employ one or more of the following options:</p>

<ol>
  <li>
    <p>Have each GA4GH Claim or sub-object be paired with an expiry timestamp.
Expiry timestamps would require users to log in occasionally via
an Broker in order to refresh claims. On a refresh, expiry timestamps can
be extended from what the previous claim may have indicated.</p>
  </li>
  <li>
    <p>Provide GA4GH Claims in the form of <a href="#term-visa-access-token">Visa Access
Tokens</a> to allow downstream Claim
Clearinghouses to periodically check the validity of the token via calls
to the /userinfo endpoint as per <a href="#at-polling">Access Token Polling</a>.</p>
  </li>
  <li>
    <p>Provide refresh tokens at every level in the system hierarchy and use
short-lived access tokens. This may require all contributing systems to
support <a href="https://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess">OIDC offline
access</a>
refresh tokens to deal with execution of processes where the user is no
longer actively involved. In the event that refresh tokens experience
errors, the systems involved must eventually revoke the ability for
downstream access tokens to be replaced via refresh tokens (although some
level of delay to reach out to a user to try to resolve the issue may be
desirable).</p>
  </li>
  <li>
    <p>Provide some other means for downstream Claim Clearinghouses or other
systems that create downstream access tokens to be informed of a material
change in upstream claims such that action can be taken to revoke the token,
revoke the refresh token, or revoke the access privileges associated with
such tokens.</p>
  </li>
</ol>

<h4 id="revoking-access-from-bad-actors">Revoking Access from Bad Actors</h4>

<p>In the event that a system or user detects that a specific user is misbehaving or
has falsified claims despite previous assurances that access was appropriate,
there MUST be a mechanism to withdrawal access from existing tokens and update
claims to prevent further tokens from being minted.</p>

<ol>
  <li>
    <p>Systems MUST have a means to revoke existing refresh tokens or remove
permissions from access tokens that are sufficiently long-lived enough to
warrant taking action.</p>

    <ul>
      <li>
        <p>If an access token is long-lived, then the access token MUST be
revocable, and once revoked the /userinfo endpoint MUST NOT return
claims. In this event, an appropriate error status MUST be returned as per
<a href="https://openid.net/specs/openid-connect-core-1_0.html#UserInfoError">section 5.3.3 of the OIDC specification</a>.</p>
      </li>
      <li>
        <p><a href="#at-polling">Access Token Polling</a> can allow downstream systems to detect
token revocation and remove access accordingly.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>A process MUST exist, manual or automated, to eventually remove or invalidate
related claims from the <a href="#term-claim-repository">Claim Repository</a>.</p>
  </li>
</ol>

<h4 id="limited-damage-of-leaked-tokens">Limited Damage of Leaked Tokens</h4>

<p>In order to limit damage of leaked tokens, systems MUST provide all of the
following:</p>

<ol>
  <li>
    <p>Be able to leverage mechanisms in place for revoking claims and tokens
for other purposes to also limit exposure of leaked tokens.</p>
  </li>
  <li>
    <p>Follow best practices for the safekeeping of refresh tokens or longer lived
tokens (should longer lived tokens be needed).</p>
  </li>
  <li>
    <p>Limit the life of refresh tokens or long-lived keys before an auth challenge
occurs or otherwise the refresh token simply fails to generate more access
tokens.</p>
  </li>
  <li>
    <p>Any signed tokens that may be stored by participating services SHOULD be
encrypted at rest and follow best practices to limit the ability of
administrators from decrypting this content.</p>
  </li>
</ol>

<h3 id="appendix---sequence-diagrams">Appendix - Sequence Diagrams</h3>

<p>The following sequence diagrams are included to help explain the intended flows
documented in this specification. However the diagrams are non-normative - if there are
any discrepancies between the diagrams and the text of the specification, the text
of the specification will take precedence.</p>

<h4 id="callback-userinfo-flow">Callback (Userinfo) Flow</h4>

<p>The flow as used by Elixir uses the initial <em>Passport-Scoped OAuth Access Token</em> as
a token handed to downstream resource servers. These servers can use this token, in conjunction
with a callback to the <code class="language-plaintext highlighter-rouge">/userinfo</code> endpoint of the broker, to obtain the <em>Passport</em> content in
JSON format.</p>

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" preserveaspectratio="none" version="1.1" viewbox="0 0 1172 954" zoomandpan="magnify">
  <defs>
    <filter height="300%" id="f1fuewzvb34s8h" width="300%" x="-1" y="-1">
      <fegaussianblur result="blurOut" stddeviation="2.0"></fegaussianblur>
      <fecolormatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></fecolormatrix>
      <feoffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feoffset>
      <feblend in="SourceGraphic" in2="blurOut3" mode="normal"></feblend>
    </filter>
  </defs>
  <g>
    <rect fill="#EEEEEE" height="935.0781" style="stroke:#A80036;stroke-width:1.0;" width="264" x="11" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="83" x="101.5" y="18.0669">Researcher</text>
    <rect fill="#DDDDDD" height="935.0781" style="stroke:#A80036;stroke-width:1.0;" width="251" x="297" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="24" x="410.5" y="18.0669">AAI</text>
    <rect fill="#DDDDDD" height="935.0781" style="stroke:#A80036;stroke-width:1.0;" width="162" x="594" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="87" x="631.5" y="18.0669">Data Owner</text>
    <rect fill="#DDDDDD" height="935.0781" style="stroke:#A80036;stroke-width:1.0;" width="271" x="778" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="89" x="869" y="18.0669">Data Holder</text>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="56" x2="56" y1="108.4297" y2="947.0781"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="222" x2="222" y1="108.4297" y2="947.0781"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="353" x2="353" y1="108.4297" y2="947.0781"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="502" x2="502" y1="108.4297" y2="947.0781"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="675" x2="675" y1="108.4297" y2="947.0781"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="863" x2="863" y1="108.4297" y2="947.0781"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1000" x2="1000" y1="108.4297" y2="947.0781"></line>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="77" x="15" y="105.1279">User Agent</text>
    <ellipse cx="56.5" cy="35.1328" fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"></ellipse>
    <path d="M56.5,43.1328 L56.5,70.1328 M43.5,51.1328 L69.5,51.1328 M56.5,70.1328 L43.5,85.1328 M56.5,70.1328 L69.5,85.1328 " fill="none" filter="url(#f1fuewzvb34s8h)" style="stroke:#A80036;stroke-width:2.0;"></path>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="53" x="194" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="39" x="201" y="93.1279">Client</text>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="60" x="321" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="46" x="328" y="93.1279">Broker</text>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="35" x="485" y="69.1328"></rect>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="35" x="481" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="21" x="488" y="93.1279">IdP</text>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="106" x="622" y="69.1328"></rect>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="106" x="618" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="92" x="625" y="93.1279">Visa Issuer(s)</text>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="802" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="105" x="809" y="93.1279">Clearing House</text>
    <rect fill="#FEFECE" filter="url(#f1fuewzvb34s8h)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="975" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="32" x="982" y="93.1279">Data</text>
    <rect fill="#EEEEEE" filter="url(#f1fuewzvb34s8h)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1165" x="0" y="138.9961"></rect>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1165" y1="138.9961" y2="138.9961"></line>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1165" y1="141.9961" y2="141.9961"></line>
    <rect fill="#EEEEEE" filter="url(#f1fuewzvb34s8h)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="50" x="557.5" y="128.4297"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="36" x="563.5" y="144.4966">OIDC</text>
    <rect fill="#FFFFFF" filter="url(#f1fuewzvb34s8h)" height="40.2656" style="stroke:#000000;stroke-width:2.0;" width="531" x="12" y="161.5625"></rect>
    <path d="M12,161.5625 L78,161.5625 L78,168.5625 L68,178.5625 L12,178.5625 L12,161.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="21" x="25" y="175.6294">ref</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="513" x="23" y="194.6294">OIDC flow results in the client holding a *Passport-Scoped OAuth Access Token*.</text>
    <rect fill="#EEEEEE" filter="url(#f1fuewzvb34s8h)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1165" x="0" y="227.3945"></rect>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1165" y1="227.3945" y2="227.3945"></line>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1165" y1="230.3945" y2="230.3945"></line>
    <rect fill="#EEEEEE" filter="url(#f1fuewzvb34s8h)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="41" x="562" y="216.8281"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="27" x="568" y="232.895">Use</text>
    <polygon fill="#A80036" points="210.5,282.2266,220.5,286.2266,210.5,290.2266,214.5,286.2266" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="216.5" y1="286.2266" y2="286.2266"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="127" x="63.5" y="266.0278">User instructs client</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="142" x="63.5" y="281.1606">regarding data access</text>
    <polygon fill="#A80036" points="851.5,311.3594,861.5,315.3594,851.5,319.3594,855.5,315.3594" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="222.5" x2="857.5" y1="315.3594" y2="315.3594"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="123" x="229.5" y="310.2935">Client asks for data</text>
    <path d="M160,328.3594 L160,383.3594 L926,383.3594 L926,338.3594 L916,328.3594 L160,328.3594 " fill="#CCCCCC" filter="url(#f1fuewzvb34s8h)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M916,328.3594 L916,338.3594 L926,338.3594 L916,328.3594 " fill="#CCCCCC" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="327.5" y="345.4263">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="406" x="339.5" y="360.5591">Authorization: Bearer &lt;Passport-Scoped OAuth Access Token&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="327.5" y="375.6919">}</text>
    <polygon fill="#A80036" points="364,409.8906,354,413.8906,364,417.8906,360,413.8906" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="358" x2="862.5" y1="413.8906" y2="413.8906"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="244" x="370" y="408.8247">Please give me details of the passport</text>
    <path d="M288,426.8906 L288,481.8906 L927,481.8906 L927,436.8906 L917,426.8906 L288,426.8906 " fill="#CCCCCC" filter="url(#f1fuewzvb34s8h)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M917,426.8906 L917,436.8906 L927,436.8906 L917,426.8906 " fill="#CCCCCC" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="394" y="443.9575">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="406" x="402" y="459.0903">Authorization: Bearer &lt;Passport-Scoped OAuth Access Token&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="394" y="474.2231">}</text>
    <polygon fill="#A80036" points="663,508.4219,673,512.4219,663,516.4219,667,512.4219" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="353" x2="669" y1="512.4219" y2="512.4219"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="245" x="360" y="507.356">(optional) Fetch signed visa(s) for user</text>
    <path d="M291,525.4219 L291,595.4219 L737,595.4219 L737,535.4219 L727,525.4219 L291,525.4219 " fill="#FBFB77" filter="url(#f1fuewzvb34s8h)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M727,525.4219 L727,535.4219 L737,535.4219 L727,525.4219 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="5" x="474" y="542.4888">[</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="59" x="482" y="557.6216">&lt;visa1&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="59" x="482" y="572.7544">&lt;visa2&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="5" x="474" y="587.8872">]</text>
    <polygon fill="#A80036" points="364,622.0859,354,626.0859,364,630.0859,360,626.0859" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="358" x2="674" y1="626.0859" y2="626.0859"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="252" x="370" y="621.02">(optional) Return signed visa(s) for user</text>
    <polygon fill="#A80036" points="851.5,651.2188,861.5,655.2188,851.5,659.2188,855.5,655.2188" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="353" x2="857.5" y1="655.2188" y2="655.2188"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="102" x="360" y="650.1528">Return passport</text>
    <path d="M288,668.2188 L288,829.2188 L927,829.2188 L927,678.2188 L917,668.2188 L288,668.2188 " fill="#CCCCCC" filter="url(#f1fuewzvb34s8h)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M917,668.2188 L917,678.2188 L927,678.2188 L917,668.2188 " fill="#CCCCCC" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="443.5" y="685.2856">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="226" x="451.5" y="700.4185">"iss": "https://broker.example.com",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="112" x="451.5" y="715.5513">"sub": &lt;clientid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="307" x="451.5" y="730.6841">"jti": "071f99cc-0b52-11ec-96c2-374f836e9e79",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="148" x="451.5" y="745.8169">"ga4gh_passport_v1": [</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="59" x="459.5" y="760.9497">&lt;visa1&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="59" x="459.5" y="776.0825">&lt;visa2&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="12" x="459.5" y="791.2153">...</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="5" x="451.5" y="806.3481">]</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="443.5" y="821.481">}</text>
    <path d="M703,843.5469 L703,898.5469 L1156,898.5469 L1156,853.5469 L1146,843.5469 L703,843.5469 " fill="#FFCCCB" filter="url(#f1fuewzvb34s8h)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M1146,843.5469 L1146,853.5469 L1156,853.5469 L1146,843.5469 " fill="#FFCCCB" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="432" x="709" y="860.6138">Decision is made to release data using information contained in the</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="425" x="709" y="875.7466">passport - and this decision is coordinated with the data system to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="215" x="709" y="890.8794">facilitate that actual data release.</text>
    <polygon fill="#A80036" points="233.5,925.0781,223.5,929.0781,233.5,933.0781,229.5,929.0781" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="227.5" x2="862.5" y1="929.0781" y2="929.0781"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="75" x="239.5" y="924.0122">Return data</text>
    <!--MD5=[b71f9695d83d5fd5a82edfd3d81bdbf7]
@startuml
skinparamlocked svgDimensionStyle false


hide footbox
skinparam BoxPadding 10
skinparam ParticipantPadding 20

box "Researcher"  #eee
actor       "User Agent"                as user
participant Client                      as client
end box

box "AAI"
participant Broker                      as broker
collections "IdP"                       as idps
end box

box "Data Owner"
collections "Visa Issuer(s)"            as issuers
end box

box "Data Holder"
participant "Clearing House"            as clearing
participant "Data"                      as data
end box

==OIDC==

ref over user, client, broker, idps
OIDC flow results in the client holding a *Passport-Scoped OAuth Access Token*.
end ref

==Use==

user -> client : User instructs client\nregarding data access
client -> clearing : Client asks for data
note over client, clearing  #CCCCCC
{
   Authorization: Bearer <Passport-Scoped OAuth Access Token>
}
end note

clearing -> broker : Please give me details of the passport
note over broker, clearing  #CCCCCC
{
  Authorization: Bearer <Passport-Scoped OAuth Access Token>
}
end note

broker -> issuers : (optional) Fetch signed visa(s) for user
note over broker, issuers
[
  <visa1>,
  <visa2>,
]
end note
broker <- issuers : (optional) Return signed visa(s) for user


clearing <- broker : Return passport
note over broker, clearing  #CCCCCC
{
  "iss": "https://broker.example.com",
  "sub": <clientid>,
  "jti": "071f99cc-0b52-11ec-96c2-374f836e9e79",
  "ga4gh_passport_v1": [
    <visa1>,
    <visa2>,
    ...
  ]
}
end note


note over clearing, data  #FFCCCB
Decision is made to release data using information contained in the
passport - and this decision is coordinated with the data system to
facilitate that actual data release.
end note

client <- clearing : Return data



@enduml

PlantUML version 1.2021.10(Mon Aug 30 13:43:48 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
-->
  </g>
</svg>

<h4 id="exchange-flow">Exchange Flow</h4>

<p>The exchange flow does not ever distribute the initial <em>Passport-Scoped OAuth Access Token</em> beyond
the client application. A token exchange operation is executed by the client, in
exchange for a <em>Passport Access Token</em> (need precise name), a <em>Work Order Token</em> (same) - or any
other token that may be used downstream to access resources. In this example flow, the
 <em>Passport Access Token</em> is used as a bearer token - though noting that the potential large size
and overly generous scope of these tokens may limit the general availability of this technique.</p>

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" preserveaspectratio="none" version="1.1" viewbox="0 0 1181 1157" zoomandpan="magnify">
  <defs>
    <filter height="300%" id="f16on1p7b7pqec" width="300%" x="-1" y="-1">
      <fegaussianblur result="blurOut" stddeviation="2.0"></fegaussianblur>
      <fecolormatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></fecolormatrix>
      <feoffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feoffset>
      <feblend in="SourceGraphic" in2="blurOut3" mode="normal"></feblend>
    </filter>
  </defs>
  <g>
    <rect fill="#EEEEEE" height="1138.4063" style="stroke:#A80036;stroke-width:1.0;" width="264" x="11" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="83" x="101.5" y="18.0669">Researcher</text>
    <rect fill="#DDDDDD" height="1138.4063" style="stroke:#A80036;stroke-width:1.0;" width="210.5" x="337.5" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="24" x="430.75" y="18.0669">AAI</text>
    <rect fill="#DDDDDD" height="1138.4063" style="stroke:#A80036;stroke-width:1.0;" width="162" x="594" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="87" x="631.5" y="18.0669">Data Owner</text>
    <rect fill="#DDDDDD" height="1138.4063" style="stroke:#A80036;stroke-width:1.0;" width="271" x="778" y="6"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="89" x="869" y="18.0669">Data Holder</text>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="56" x2="56" y1="108.4297" y2="1150.4063"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="222" x2="222" y1="108.4297" y2="1150.4063"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="393.5" x2="393.5" y1="108.4297" y2="1150.4063"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="502" x2="502" y1="108.4297" y2="1150.4063"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="675" x2="675" y1="108.4297" y2="1150.4063"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="863" x2="863" y1="108.4297" y2="1150.4063"></line>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1000" x2="1000" y1="108.4297" y2="1150.4063"></line>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="77" x="15" y="105.1279">User Agent</text>
    <ellipse cx="56.5" cy="35.1328" fill="#FEFECE" filter="url(#f16on1p7b7pqec)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"></ellipse>
    <path d="M56.5,43.1328 L56.5,70.1328 M43.5,51.1328 L69.5,51.1328 M56.5,70.1328 L43.5,85.1328 M56.5,70.1328 L69.5,85.1328 " fill="none" filter="url(#f16on1p7b7pqec)" style="stroke:#A80036;stroke-width:2.0;"></path>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="53" x="194" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="39" x="201" y="93.1279">Client</text>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="60" x="361.5" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="46" x="368.5" y="93.1279">Broker</text>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="35" x="485" y="69.1328"></rect>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="35" x="481" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="21" x="488" y="93.1279">IdP</text>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="106" x="622" y="69.1328"></rect>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="106" x="618" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="92" x="625" y="93.1279">Visa Issuer(s)</text>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="119" x="802" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="105" x="809" y="93.1279">Clearing House</text>
    <rect fill="#FEFECE" filter="url(#f16on1p7b7pqec)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="975" y="73.1328"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="32" x="982" y="93.1279">Data</text>
    <rect fill="#EEEEEE" filter="url(#f16on1p7b7pqec)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1174" x="0" y="138.9961"></rect>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1174" y1="138.9961" y2="138.9961"></line>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1174" y1="141.9961" y2="141.9961"></line>
    <rect fill="#EEEEEE" filter="url(#f16on1p7b7pqec)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="50" x="562" y="128.4297"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="36" x="568" y="144.4966">OIDC</text>
    <rect fill="#FFFFFF" filter="url(#f16on1p7b7pqec)" height="40.2656" style="stroke:#000000;stroke-width:2.0;" width="531" x="12" y="161.5625"></rect>
    <path d="M12,161.5625 L78,161.5625 L78,168.5625 L68,178.5625 L12,178.5625 L12,161.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="21" x="25" y="175.6294">ref</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="513" x="23" y="194.6294">OIDC flow results in the client holding a *Passport-Scoped OAuth Access Token*.</text>
    <rect fill="#EEEEEE" filter="url(#f16on1p7b7pqec)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1174" x="0" y="227.3945"></rect>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1174" y1="227.3945" y2="227.3945"></line>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1174" y1="230.3945" y2="230.3945"></line>
    <rect fill="#EEEEEE" filter="url(#f16on1p7b7pqec)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="85" x="544.5" y="216.8281"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="71" x="550.5" y="232.895">Exchange</text>
    <polygon fill="#A80036" points="210.5,282.2266,220.5,286.2266,210.5,290.2266,214.5,286.2266" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="216.5" y1="286.2266" y2="286.2266"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="127" x="63.5" y="266.0278">User instructs client</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="142" x="63.5" y="281.1606">regarding data access</text>
    <polygon fill="#A80036" points="381.5,311.3594,391.5,315.3594,381.5,319.3594,385.5,315.3594" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="222.5" x2="387.5" y1="315.3594" y2="315.3594"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="104" x="229.5" y="310.2935">Token exchange</text>
    <path d="M76,328.3594 L76,428.3594 L535,428.3594 L535,338.3594 L525,328.3594 L76,328.3594 " fill="#FBFB77" filter="url(#f16on1p7b7pqec)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M525,328.3594 L525,338.3594 L535,338.3594 L525,328.3594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="317" x="82" y="345.4263">Content-Type: application/x-www-form-urlencoded</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="0" x="86" y="360.5591"></text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="397" x="82" y="375.6919">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="180" x="82" y="390.8247">requested_token_type=TBD</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="366" x="82" y="405.9575">subject_token=&lt;Passport-Scoped OAuth Access Token&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="438" x="82" y="421.0903">subject_token_type=urn:ietf:params:oauth:token-type:access_token</text>
    <polygon fill="#A80036" points="663,455.2891,673,459.2891,663,463.2891,667,459.2891" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="393.5" x2="669" y1="459.2891" y2="459.2891"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="245" x="400.5" y="454.2231">(optional) Fetch signed visa(s) for user</text>
    <path d="M331,472.2891 L331,542.2891 L736,542.2891 L736,482.2891 L726,472.2891 L331,472.2891 " fill="#FBFB77" filter="url(#f16on1p7b7pqec)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M726,472.2891 L726,482.2891 L736,482.2891 L726,472.2891 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="5" x="496.75" y="489.356">[</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="53" x="504.75" y="504.4888">"evb....",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="53" x="504.75" y="519.6216">"evb....",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="5" x="496.75" y="534.7544">]</text>
    <polygon fill="#A80036" points="404.5,568.9531,394.5,572.9531,404.5,576.9531,400.5,572.9531" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="398.5" x2="674" y1="572.9531" y2="572.9531"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="252" x="410.5" y="567.8872">(optional) Return signed visa(s) for user</text>
    <polygon fill="#A80036" points="233.5,598.0859,223.5,602.0859,233.5,606.0859,229.5,602.0859" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="227.5" x2="392.5" y1="602.0859" y2="602.0859"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="147" x="239.5" y="597.02">Token exchange return</text>
    <path d="M85,615.0859 L85,715.0859 L527,715.0859 L527,625.0859 L517,615.0859 L85,615.0859 " fill="#FBFB77" filter="url(#f16on1p7b7pqec)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M517,615.0859 L517,625.0859 L527,625.0859 L517,615.0859 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="91" y="632.1528">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="413" x="99" y="647.2856">"access_token": "... BASE 64 JWT PASSPORT_ACCESS_TOKEN ...",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="189" x="99" y="662.4185">"issued_token_type": &lt;TBD&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="142" x="99" y="677.5513">"token_type":"Bearer",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="94" x="99" y="692.6841">"expires_in":60</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="91" y="707.8169">}</text>
    <path d="M160,729.8828 L160,890.8828 L926,890.8828 L926,739.8828 L916,729.8828 L160,729.8828 " fill="#CCCCCC" filter="url(#f16on1p7b7pqec)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M916,729.8828 L916,739.8828 L926,739.8828 L916,729.8828 " fill="#CCCCCC" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="379" y="746.9497">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="226" x="387" y="762.0825">"iss": "https://broker.example.com",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="303" x="387" y="777.2153">"sub": "https://orcid.org/0000-0002-1825-0097",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="297" x="387" y="792.3481">"aud": "https://resource-server.example.com/",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="307" x="387" y="807.481">"jti": "071f99cc-0b52-11ec-96c2-374f836e9e79",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="148" x="387" y="822.6138">"ga4gh_passport_v1": [</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="53" x="395" y="837.7466">"evb....",</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="49" x="395" y="852.8794">"evn...."</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="5" x="387" y="868.0122">]</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="379" y="883.145">}</text>
    <rect fill="#EEEEEE" filter="url(#f16on1p7b7pqec)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1174" x="0" y="920.7773"></rect>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1174" y1="920.7773" y2="920.7773"></line>
    <line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1174" y1="923.7773" y2="923.7773"></line>
    <rect fill="#EEEEEE" filter="url(#f16on1p7b7pqec)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="41" x="566.5" y="910.2109"></rect>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="27" x="572.5" y="926.2778">Use</text>
    <polygon fill="#A80036" points="851.5,960.4766,861.5,964.4766,851.5,968.4766,855.5,964.4766" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="222.5" x2="857.5" y1="964.4766" y2="964.4766"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="123" x="229.5" y="959.4106">Client asks for data</text>
    <path d="M160,977.4766 L160,1032.4766 L926,1032.4766 L926,987.4766 L916,977.4766 L160,977.4766 " fill="#CCCCCC" filter="url(#f16on1p7b7pqec)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M916,977.4766 L916,987.4766 L926,987.4766 L916,977.4766 " fill="#CCCCCC" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="362.5" y="994.5435">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="348" x="362.5" y="1009.6763">Authorization: Bearer &lt;name of token type for here?&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="8" x="362.5" y="1024.8091">}</text>
    <path d="M693,1046.875 L693,1101.875 L1165,1101.875 L1165,1056.875 L1155,1046.875 L693,1046.875 " fill="#FFCCCB" filter="url(#f16on1p7b7pqec)" style="stroke:#A80036;stroke-width:1.0;"></path>
    <path d="M1155,1046.875 L1155,1056.875 L1165,1056.875 L1155,1046.875 " fill="#FFCCCB" style="stroke:#A80036;stroke-width:1.0;"></path>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="432" x="699" y="1063.9419">Decision is made to release data using information contained in the</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="451" x="699" y="1079.0747">bearer token - and this decision is coordinated with the data system to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="215" x="699" y="1094.2075">facilitate that actual data release.</text>
    <polygon fill="#A80036" points="233.5,1128.4063,223.5,1132.4063,233.5,1136.4063,229.5,1132.4063" style="stroke:#A80036;stroke-width:1.0;"></polygon>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="227.5" x2="862.5" y1="1132.4063" y2="1132.4063"></line>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="75" x="239.5" y="1127.3403">Return data</text>
    <!--MD5=[7de42888c60106c334575de1c08e3c31]
@startuml
skinparamlocked svgDimensionStyle false


hide footbox
skinparam BoxPadding 10
skinparam ParticipantPadding 20

box "Researcher"  #eee
actor       "User Agent"                as user
participant Client                      as client
end box

box "AAI"
participant Broker                      as broker
collections "IdP"                       as idps
end box

box "Data Owner"
collections "Visa Issuer(s)"            as issuers
end box

box "Data Holder"
participant "Clearing House"            as clearing
participant "Data"            as data
end box

==OIDC==

ref over user, client, broker, idps
OIDC flow results in the client holding a *Passport-Scoped OAuth Access Token*.
end ref

==Exchange==

user -> client : User instructs client\nregarding data access
client -> broker : Token exchange
note over client, broker
Content-Type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:token-exchange
requested_token_type=TBD
subject_token=<Passport-Scoped OAuth Access Token>
subject_token_type=urn:ietf:params:oauth:token-type:access_token
end note

broker -> issuers : (optional) Fetch signed visa(s) for user
note over broker, issuers
[
  "evb....",
  "evb....",
]
end note
broker <- issuers : (optional) Return signed visa(s) for user

client <- broker : Token exchange return
note over client, broker
{
  "access_token": "... BASE 64 JWT PASSPORT_ACCESS_TOKEN ...",
  "issued_token_type": <TBD>,
  "token_type":"Bearer",
  "expires_in":60
}
end note

note over client, clearing  #CCCCCC
{
  "iss": "https://broker.example.com",
  "sub": "https://orcid.org/0000-0002-1825-0097",
  "aud": "https://resource-server.example.com/",
  "jti": "071f99cc-0b52-11ec-96c2-374f836e9e79",
  "ga4gh_passport_v1": [
    "evb....",
    "evn...."
  ]
}
end note

==Use==

client -> clearing : Client asks for data
note over client, clearing  #CCCCCC
{
Authorization: Bearer <name of token type for here?>
}
end note

note over clearing, data  #FFCCCB
Decision is made to release data using information contained in the
bearer token - and this decision is coordinated with the data system to
facilitate that actual data release.
end note

client <- clearing : Return data


@enduml

PlantUML version 1.2021.10(Mon Aug 30 13:43:48 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
-->
  </g>
</svg>

<h3 id="specification-revision-history">Specification Revision History</h3>

<table>
  <thead>
    <tr>
      <th>Version</th>
      <th>Date</th>
      <th>Editor</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1.2.0</td>
      <td>2021-07</td>
      <td>Craig Voisin …</td>
      <td>…</td>
    </tr>
    <tr>
      <td>1.1.0</td>
      <td>2021-07</td>
      <td>Craig Voisin</td>
      <td>
<em>abandoned</em> version now reserved, new concepts moved to v1.2</td>
    </tr>
    <tr>
      <td>1.0.4</td>
      <td>2021-07</td>
      <td>Craig Voisin</td>
      <td>Improve existing terminology and define Passport and Visa JWTs</td>
    </tr>
    <tr>
      <td>1.0.3</td>
      <td>2021-06</td>
      <td>Craig Voisin</td>
      <td>Links for “scope” claim</td>
    </tr>
    <tr>
      <td>1.0.2</td>
      <td>2020-02</td>
      <td>David Bernick</td>
      <td>Clarify risk scenarios</td>
    </tr>
    <tr>
      <td>1.0.1</td>
      <td>2019-10</td>
      <td>David Bernick</td>
      <td>Clarify that non-GA4GH claims are allowed in tokens</td>
    </tr>
    <tr>
      <td>1.0.0</td>
      <td>2019-10</td>
      <td>Approved by GA4GH Steering Committee</td>
      <td> </td>
    </tr>
    <tr>
      <td>0.9.9</td>
      <td>2019-10</td>
      <td>David Bernick, Craig Voisin, Mikael Linden</td>
      <td>Approved standard</td>
    </tr>
    <tr>
      <td>0.9.5</td>
      <td>2019-09</td>
      <td>Craig Voisin</td>
      <td>Update claim flow diagram and definitions</td>
    </tr>
    <tr>
      <td>0.9.4</td>
      <td>2019-08</td>
      <td>Craig Voisin</td>
      <td>Embedded tokens for signed RI Claim Objects</td>
    </tr>
    <tr>
      <td>0.9.3</td>
      <td>2019-08</td>
      <td>Craig Voisin</td>
      <td>Support for RI’s embedded tokens</td>
    </tr>
    <tr>
      <td>0.9.2</td>
      <td>2019-07</td>
      <td>David Bernick</td>
      <td>Made changes based on feedback from review</td>
    </tr>
    <tr>
      <td>0.9.1</td>
      <td>2019-06</td>
      <td>Craig Voisin</td>
      <td>Added terminology links</td>
    </tr>
    <tr>
      <td>0.9.0</td>
      <td>2017-</td>
      <td>Mikael Linden, Craig Voisin, David Bernick</td>
      <td>Initial working version</td>
    </tr>
  </tbody>
</table>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/data-security/1.2-draft-sequence-diagram/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">GA4GH Data Security</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">GA4GH Data Security</li>
</ul>
      </div>

      <div class="footer-col footer-col-2">
<ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>AAI</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
